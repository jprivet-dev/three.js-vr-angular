(self.webpackChunkapp=self.webpackChunkapp||[]).push([[349],{8349:(e,t,i)=>{"use strict";i.r(t),i.d(t,{EarthModule:()=>C});var n={};i.r(n),i.d(n,{switchAntialias:()=>h,switchDefinition:()=>d,switchFlyMode:()=>c,vrSessionEnd:()=>f,vrSessionStart:()=>l});var s=i(8583),a=i(4304),r=i(9812),o=i(5466);const c=(0,o.PH)("[Earth] switch fly mode"),d=(0,o.PH)("[Earth] switch definition"),h=(0,o.PH)("[Earth] switch antialias"),l=(0,o.PH)("[Earth] VR session start"),f=(0,o.PH)("[Earth] VR session end");(0,o.G0)(n);var u=i(7716),p=i(457),w=i(9723),S=i(3607),y=i(4007),m=i(1115),v=i(949),b=i(270),D=i(3841),$=i(9088),A=i(8656),M=i(5319);const g={fov:80,near:1,far:8e3,onVRSessionStartPosition:{camera:{x:0,y:0,z:0},dolly:{x:.5,y:0,z:2.5}},onVRSessionEndPosition:{camera:{x:0,y:0,z:5},dolly:{x:0,y:0,z:0}}};var E=i(9263);const R="earth",P=(0,o.Lq)({flyMode:!1,antialias:!1,definition:"sd",vrSession:!1},(0,o.on)(c,e=>Object.assign(Object.assign({},e),{flyMode:!e.flyMode})),(0,o.on)(d,e=>Object.assign(Object.assign({},e),{definition:"sd"===e.definition?"hd":"sd"})),(0,o.on)(h,e=>Object.assign(Object.assign({},e),{antialias:!e.antialias})),(0,o.on)(l,e=>Object.assign(Object.assign({},e),{vrSession:!0})),(0,o.on)(f,e=>Object.assign(Object.assign({},e),{vrSession:!1}))),j=(0,o.ZF)(R),O=(0,o.P1)(j,e=>e.flyMode),H=(0,o.P1)(j,e=>e.definition),F=(0,o.P1)(H,e=>"hd"===e),z=(0,o.P1)(j,e=>e.antialias),J=(0,o.P1)(j,e=>e.vrSession);let B=(()=>{class e{constructor(e){this.store=e,this.flyMode$=this.store.select(O),this.definition$=this.store.select(H),this.isHDDefinition$=this.store.select(F),this.antialias$=this.store.select(z),this.vrSession$=this.store.select(J)}dispatch(e){this.store.dispatch(e)}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(o.yh))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),I=(()=>{class e{constructor(e,t){this.store=e,this.facade=t,this.dollyCameraParams=g,this.subscription=new M.w}buildScene(e){const t=e.container;this.renderer=e.renderer;const i=new y.$,n=(new m.A(t),new v.I),s=new b.M,a=new A.d;n.add(a);const r=a.scene,o=new p.a(t,this.dollyCameraParams);r.add(o),i.add(o),this.renderer.setAnimationLoop(()=>{s.update(),this.renderer.render(r,o.camera)});const c=new S.Ck;r.add(c.light),n.add(c);const d=new D.I;r.add(d.mesh),n.add(d),s.add(d);const h=new $.J;h.mesh.position.set(2,0,0),r.add(h.mesh),n.add(h),s.add(h),this.subscription.add(this.facade.definition$.subscribe(e=>{n.loadTexturesByDefinition(e)})),this.subscription.add(this.facade.vrSession$.subscribe(e=>{e?i.onSessionStart():i.onSessionEnd()})),this.controls=new w.bq(o.camera,this.renderer.domElement,{autoRotateSpeed:.2,autoRotate:!0,target:d.mesh.position}),s.add(this.controls)}updateRenderer(e){this.renderer=e.renderer,this.controls.updateDomElement(this.renderer.domElement)}unsubscribe(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(E.d),u.LFG(B))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var L=i(6901),V=i(6534);const Z=[{path:"",component:(()=>{class e{constructor(e,t,i){this.window=e,this.service=t,this.facade=i,this.flyMode$=this.facade.flyMode$,this.isHDDefinition$=this.facade.isHDDefinition$,this.antialias$=this.facade.antialias$}onRendererInit(e){this.service.buildScene(e)}onRendererUpdate(e){this.service.updateRenderer(e)}onSwitchFlyMode(){this.facade.dispatch(c())}onSwitchDefinition(){this.facade.dispatch(d())}onSwitchAntialias(){this.facade.dispatch(h())}onVRSessionStart(){this.facade.dispatch(l())}onVRSessionEnd(){this.facade.dispatch(f())}ngOnDestroy(){this.service.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(Window),u.Y36(I),u.Y36(B))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-earth-page"]],decls:5,vars:11,consts:[[3,"antialias$","vrButton","rendererInit","rendererUpdate","vrSessionStart","vrSessionEnd"],[3,"isflyMode","isHDDefinition","isAntialias","switchFlyMode","switchDefinition","switchAntialias"]],template:function(e,t){1&e&&(u.TgZ(0,"app-renderer",0),u.NdJ("rendererInit",function(e){return t.onRendererInit(e)})("rendererUpdate",function(e){return t.onRendererUpdate(e)})("vrSessionStart",function(){return t.onVRSessionStart()})("vrSessionEnd",function(){return t.onVRSessionEnd()}),u.qZA(),u.TgZ(1,"app-menu",1),u.NdJ("switchFlyMode",function(){return t.onSwitchFlyMode()})("switchDefinition",function(){return t.onSwitchDefinition()})("switchAntialias",function(){return t.onSwitchAntialias()}),u.ALo(2,"async"),u.ALo(3,"async"),u.ALo(4,"async"),u.qZA()),2&e&&(u.Q6J("antialias$",t.antialias$)("vrButton",!0),u.xp6(1),u.Q6J("isflyMode",u.lcZ(2,5,t.flyMode$))("isHDDefinition",u.lcZ(3,7,t.isHDDefinition$))("isAntialias",u.lcZ(4,9,t.antialias$)))},directives:[L.J,V.M],pipes:[s.Ov],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.Bz.forChild(Z)],r.Bz]}),e})(),x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[o.Aw.forFeature(R,P)]]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.ez,a.m,k,x]]}),e})()}}]);