(self.webpackChunkapp=self.webpackChunkapp||[]).push([[349],{8349:(e,t,i)=>{"use strict";i.r(t),i.d(t,{EarthModule:()=>Y});var n={};i.r(n),i.d(n,{switchAntialias:()=>h,switchDefinition:()=>d,switchFlyMode:()=>c,vrSessionEnd:()=>f,vrSessionStart:()=>l});var s=i(8583),a=i(4304),o=i(9812),r=i(5466);const c=(0,r.PH)("[Earth] switch fly mode"),d=(0,r.PH)("[Earth] switch definition"),h=(0,r.PH)("[Earth] switch antialias"),l=(0,r.PH)("[Earth] VR session start"),f=(0,r.PH)("[Earth] VR session end");(0,r.G0)(n);var u=i(7716),p=i(457),w=i(9723),S=i(3607),y=i(4007),m=i(1115),v=i(949),b=i(270),M=i(4997),D=i(3841),$=i(9088),g=i(8656),A=i(5319);const R={fov:80,near:1,far:8e3,onVRSessionStartPosition:{camera:{x:0,y:0,z:0},dolly:{x:.5,y:0,z:2.5}},onVRSessionEndPosition:{camera:{x:0,y:0,z:5},dolly:{x:0,y:0,z:0}}};var E=i(9263);const P="earth",j=(0,r.Lq)({flyMode:!1,antialias:!1,definition:"sd",vrSession:!1},(0,r.on)(c,e=>Object.assign(Object.assign({},e),{flyMode:!e.flyMode})),(0,r.on)(d,e=>Object.assign(Object.assign({},e),{definition:"sd"===e.definition?"hd":"sd"})),(0,r.on)(h,e=>Object.assign(Object.assign({},e),{antialias:!e.antialias})),(0,r.on)(l,e=>Object.assign(Object.assign({},e),{vrSession:!0})),(0,r.on)(f,e=>Object.assign(Object.assign({},e),{vrSession:!1}))),O=(0,r.ZF)(P),H=(0,r.P1)(O,e=>e.flyMode),F=(0,r.P1)(O,e=>e.definition),z=(0,r.P1)(F,e=>"hd"===e),J=(0,r.P1)(O,e=>e.antialias),B=(0,r.P1)(O,e=>e.vrSession);let I=(()=>{class e{constructor(e){this.store=e,this.flyMode$=this.store.select(H),this.definition$=this.store.select(F),this.isHDDefinition$=this.store.select(z),this.antialias$=this.store.select(J),this.vrSession$=this.store.select(B)}dispatch(e){this.store.dispatch(e)}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(r.yh))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),V=(()=>{class e{constructor(e,t){this.store=e,this.facade=t,this.dollyCameraParams=R,this.subscription=new A.w}buildScene({container:e,renderer:t}){const i=new y.$,n=new m.A(e),s=new v.I,a=new b.M,o=new g.d;s.add(o);const r=o.scene,c=new p.a(e,this.dollyCameraParams);r.add(c),i.add(c),this.rendererManager=new M.T(a,t,r,c.camera),n.add(this.rendererManager);const d=new S.Ck;r.add(d.light),s.add(d);const h=new D.I;r.add(h.mesh),s.add(h),a.add(h);const l=new $.J;l.mesh.position.set(2,0,0),r.add(l.mesh),s.add(l),a.add(l),this.subscription.add(this.facade.definition$.subscribe(e=>{s.loadTexturesByDefinition(e)})),this.subscription.add(this.facade.vrSession$.subscribe(e=>{e?i.onSessionStart():i.onSessionEnd()})),this.controls=new w.bq(c.camera,t.domElement,{autoRotateSpeed:.2,autoRotate:!0,target:h.mesh.position}),a.add(this.controls)}updateRenderer({renderer:e}){this.rendererManager.updateRenderer(e),this.controls.updateDomElement(e.domElement)}unsubscribe(){this.subscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(E.d),u.LFG(I))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Z=i(6901),k=i(6534);const L=[{path:"",component:(()=>{class e{constructor(e,t,i){this.window=e,this.service=t,this.facade=i,this.flyMode$=this.facade.flyMode$,this.isHDDefinition$=this.facade.isHDDefinition$,this.antialias$=this.facade.antialias$}onRendererInit(e){this.service.buildScene(e)}onRendererUpdate(e){this.service.updateRenderer(e)}onSwitchFlyMode(){this.facade.dispatch(c())}onSwitchDefinition(){this.facade.dispatch(d())}onSwitchAntialias(){this.facade.dispatch(h())}onVRSessionStart(){this.facade.dispatch(l())}onVRSessionEnd(){this.facade.dispatch(f())}ngOnDestroy(){this.service.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(Window),u.Y36(V),u.Y36(I))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-earth-page"]],decls:5,vars:11,consts:[[3,"antialias$","vrButton","rendererInit","rendererUpdate","vrSessionStart","vrSessionEnd"],[3,"isflyMode","isHDDefinition","isAntialias","switchFlyMode","switchDefinition","switchAntialias"]],template:function(e,t){1&e&&(u.TgZ(0,"app-renderer",0),u.NdJ("rendererInit",function(e){return t.onRendererInit(e)})("rendererUpdate",function(e){return t.onRendererUpdate(e)})("vrSessionStart",function(){return t.onVRSessionStart()})("vrSessionEnd",function(){return t.onVRSessionEnd()}),u.qZA(),u.TgZ(1,"app-menu",1),u.NdJ("switchFlyMode",function(){return t.onSwitchFlyMode()})("switchDefinition",function(){return t.onSwitchDefinition()})("switchAntialias",function(){return t.onSwitchAntialias()}),u.ALo(2,"async"),u.ALo(3,"async"),u.ALo(4,"async"),u.qZA()),2&e&&(u.Q6J("antialias$",t.antialias$)("vrButton",!0),u.xp6(1),u.Q6J("isflyMode",u.lcZ(2,5,t.flyMode$))("isHDDefinition",u.lcZ(3,7,t.isHDDefinition$))("isAntialias",u.lcZ(4,9,t.antialias$)))},directives:[Z.J,k.M],pipes:[s.Ov],styles:[""]}),e})()}];let x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[o.Bz.forChild(L)],o.Bz]}),e})(),C=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[r.Aw.forFeature(P,j)]]}),e})(),Y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[s.ez,a.m,x,C]]}),e})()}}]);